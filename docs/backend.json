
{
  "entities": {
    "AccessPrincipal": {
      "title": "Access Principal",
      "description": "Represents an access principal (user, system, bot) based on the architecture's AccessPrincipal.",
      "type": "object",
      "properties": {
        "principalId": { "type": "string" },
        "identityId": { "type": "string" },
        "type": { "type": "string", "enum": ["human", "system", "bot"] },
        "status": { "type": "string" }
      },
      "required": ["principalId", "identityId", "type", "status"]
    },
    "AccessRole": {
      "title": "Access Role",
      "description": "Defines a named role.",
      "type": "object",
      "properties": {
        "roleId": { "type": "string" },
        "name": { "type": "string" }
      },
      "required": ["roleId", "name"]
    },
    "AccessPolicy": {
      "title": "Access Policy",
      "description": "Specifies a permission for an action on a resource type.",
      "type": "object",
      "properties": {
        "policyId": { "type": "string" },
        "roleId": { "type": "string" },
        "action": { "type": "string" },
        "resourceType": { "type": "string" },
        "effect": { "type": "string", "enum": ["allow", "deny"] }
      },
      "required": ["policyId", "roleId", "action", "resourceType", "effect"]
    },
    "AccessRoleAssignment": {
      "title": "Access Role Assignment",
      "description": "Assigns a role to a principal within a scope.",
      "type": "object",
      "properties": {
        "assignmentId": { "type": "string" },
        "principalId": { "type": "string" },
        "roleId": { "type": "string" },
        "scopeType": { "type": "string", "enum": ["tenant", "workspace"] },
        "scopeId": { "type": "string" }
      },
      "required": ["assignmentId", "principalId", "roleId", "scopeType", "scopeId"]
    },
    "Tenant": {
      "title": "Tenant",
      "description": "Represents the TenantAggregate.",
      "type": "object",
      "properties": {
        "tenantId": { "type": "string" },
        "type": { "type": "string", "enum": ["personal", "organization"] },
        "status": { "type": "string" },
        "createdAt": { "type": "string", "format": "date-time" }
      },
      "required": ["tenantId", "type", "status", "createdAt"]
    },
    "TenantMember": {
      "title": "Tenant Member",
      "description": "Membership of a principal in a tenant.",
      "type": "object",
      "properties": {
        "tenantId": { "type": "string" },
        "principalId": { "type": "string" },
        "joinedAt": { "type": "string", "format": "date-time" }
      },
      "required": ["tenantId", "principalId"]
    },
    "TenantPartnership": {
      "title": "Tenant Partnership",
      "description": "Relationship between two tenants.",
      "type": "object",
      "properties": {
        "partnershipId": { "type": "string" },
        "sourceTenantId": { "type": "string" },
        "targetTenantId": { "type": "string" },
        "trustLevel": { "type": "string" },
        "status": { "type": "string" }
      },
      "required": ["partnershipId", "sourceTenantId", "targetTenantId", "status"]
    },
    "Workspace": {
      "title": "Workspace",
      "description": "Represents the WorkspaceAggregate.",
      "type": "object",
      "properties": {
        "workspaceId": { "type": "string" },
        "tenantId": { "type": "string" },
        "status": { "type": "string" },
        "visibility": { "type": "string" }
      },
      "required": ["workspaceId", "tenantId", "status", "visibility"]
    },
    "WorkspaceMember": {
      "title": "Workspace Member",
      "description": "Membership of a principal in a workspace.",
      "type": "object",
      "properties": {
        "workspaceId": { "type": "string" },
        "principalId": { "type": "string" }
      },
      "required": ["workspaceId", "principalId"]
    },
    "Task": {
      "title": "Task",
      "description": "Represents the TaskAggregate.",
      "type": "object",
      "properties": {
        "taskId": { "type": "string" },
        "workspaceId": { "type": "string" },
        "status": { "type": "string", "enum": ["proposed", "scheduled", "completed"] }
      },
      "required": ["taskId", "workspaceId", "status"]
    },
    "QA": {
      "title": "QA",
      "description": "Represents the QaAggregate.",
      "type": "object",
      "properties": {
        "qaId": { "type": "string" },
        "taskId": { "type": "string" },
        "status": { "type": "string", "enum": ["pending", "passed", "failed"] }
      },
      "required": ["qaId", "taskId", "status"]
    },
    "Acceptance": {
      "title": "Acceptance",
      "description": "Represents the AcceptanceAggregate.",
      "type": "object",
      "properties": {
        "acceptanceId": { "type": "string" },
        "qaId": { "type": "string" },
        "status": { "type": "string", "enum": ["pending", "accepted", "rejected"] }
      },
      "required": ["acceptanceId", "qaId", "status"]
    },
    "Finance": {
      "title": "Finance",
      "description": "Represents the FinanceAggregate.",
      "type": "object",
      "properties": {
        "financeId": { "type": "string" },
        "acceptanceId": { "type": "string" },
        "status": { "type": "string", "enum": ["pending", "completed", "failed"] }
      },
      "required": ["financeId", "acceptanceId", "status"]
    },
    "Issue": {
      "title": "Issue",
      "description": "Represents the IssueAggregate.",
      "type": "object",
      "properties": {
        "issueId": { "type": "string" },
        "originAggregateType": { "type": "string" },
        "originAggregateId": { "type": "string" },
        "status": { "type": "string", "enum": ["open", "resolved", "closed"] }
      },
      "required": ["issueId", "originAggregateType", "originAggregateId", "status"]
    },
    "File": {
      "title": "File",
      "description": "Represents the FileAggregate.",
      "type": "object",
      "properties": {
        "fileId": { "type": "string" },
        "workspaceId": { "type": "string" },
        "name": { "type": "string" },
        "type": { "type": "string" },
        "url": { "type": "string", "format": "uri" }
      },
      "required": ["fileId", "workspaceId", "name", "type", "url"]
    },
    "Diary": {
      "title": "Diary",
      "description": "Represents the DiaryAggregate.",
      "type": "object",
      "properties": {
        "diaryId": { "type": "string" },
        "workspaceId": { "type": "string" },
        "authorPrincipalId": { "type": "string" },
        "content": { "type": "string" },
        "visibility": { "type": "string", "enum": ["public", "workspace", "private"] },
        "createdAt": { "type": "string", "format": "date-time" },
        "status": { "type": "string", "enum": ["active", "archived"] }
      },
      "required": ["diaryId", "workspaceId", "authorPrincipalId", "content", "visibility", "createdAt", "status"]
    },
    "AuditLog": {
        "title": "Audit Log",
        "description": "Represents the AuditLog.",
        "type": "object",
        "properties": {
            "auditId": { "type": "string" },
            "eventId": {"type": "string"},
            "aggregateType": {"type": "string"},
            "aggregateId": {"type": "string"},
            "principalId": {"type": "string"},
            "action": {"type": "string"},
            "occurredAt": {"type": "string", "format": "date-time"}
        },
        "required": ["auditId", "eventId", "aggregateType", "aggregateId", "principalId", "action", "occurredAt"]
    }
  },
  "firestore": {
    "collections": {
      "principals": {
        "path": "/principals/{principalId}",
        "schema": { "$ref": "#/entities/AccessPrincipal" }
      },
      "roles": {
        "path": "/roles/{roleId}",
        "schema": { "$ref": "#/entities/AccessRole" },
        "subcollections": {
            "policies": {
                "path": "/policies/{policyId}",
                "schema": { "$ref": "#/entities/AccessPolicy" }
            }
        }
      },
      "roleAssignments": {
        "path": "/roleAssignments/{assignmentId}",
        "schema": { "$ref": "#/entities/AccessRoleAssignment" }
      },
      "tenants": {
        "path": "/tenants/{tenantId}",
        "schema": { "$ref": "#/entities/Tenant" },
        "subcollections": {
          "members": {
            "path": "/members/{principalId}",
            "schema": { "$ref": "#/entities/TenantMember" }
          },
          "auditLogs": {
            "path": "/auditLogs/{logId}",
            "schema": { "$ref": "#/entities/AuditLog" }
          },
          "workspaces": {
            "path": "/workspaces/{workspaceId}",
            "schema": { "$ref": "#/entities/Workspace" },
            "subcollections": {
              "members": {
                "path": "/members/{principalId}",
                "schema": { "$ref": "#/entities/WorkspaceMember" }
              },
              "tasks": {
                "path": "/tasks/{taskId}",
                "schema": { "$ref": "#/entities/Task" }
              },
              "qas": {
                "path": "/qas/{qaId}",
                "schema": { "$ref": "#/entities/QA" }
              },
              "acceptances": {
                "path": "/acceptances/{acceptanceId}",
                "schema": { "$ref": "#/entities/Acceptance" }
              },
              "finances": {
                "path": "/finances/{financeId}",
                "schema": { "$ref": "#/entities/Finance" }
              },
              "issues": {
                "path": "/issues/{issueId}",
                "schema": { "$ref": "#/entities/Issue" }
              },
              "files": {
                "path": "/files/{fileId}",
                "schema": { "$ref": "#/entities/File" }
              },
              "diaries": {
                "path": "/diaries/{diaryId}",
                "schema": { "$ref": "#/entities/Diary" }
              }
            }
          }
        }
      },
      "partnerships": {
        "path": "/partnerships/{partnershipId}",
        "schema": { "$ref": "#/entities/TenantPartnership" }
      }
    }
  }
}
